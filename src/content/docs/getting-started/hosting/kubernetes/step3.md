+++
title="Step 3: バックアップ設定"
weight=3
+++

{{< notice info >}}
ここで提供されるバックアップの設定はあくまでも一例です。運用環境にそのまま当てはめられない場合は、cronjobを直接書き換えてカスタマイズすると良いでしょう。
{{< /notice >}}


オプションではありますが、定期バックアップを設定していると心強いです。

S3互換のオブジェクトストレージをバックアップ先と指定することができます。

values.yamlを該当箇所を変更します。

```yaml
backup:
  enabled: true # バックアップを有効にする
  cron: "0 20 * * *" # バックアップを実行する時刻・頻度をcron形式で指定します。 これは毎日朝4時(JST)にバックアップを実行する例です。
  s3key: "s3://examplebucket/" # バケット名を指定します。
  aws_access_key_id: ""
  aws_secret_access_key: ""
  aws_default_region: "ap-northeast-1" # リージョンを指定します。cloudflare r2の場合は`auto`を指定します。
  aws_endpoint_url: "" # AWSのS3の場合は不要です。Cloudflare R2の場合はAPIキーを作成する画面で表示されるエンドポイントを指定します。
  perfixformat: "%Y%m%d-" # バックアップファイル名のプレフィックスを指定します。バケットのバージョニングを指定している場合は、空欄にしてもよいでしょう。
```

## 推奨事項
毎日のバックアップを全て保存すると、当然ストレージ容量が増えていきます。

AWS S3をはじめCloudflare R2などはオブジェクトのバージョニング機能を持っています。
30日より古いデータを自動で削除するなど、適切な設定を行うことで、ストレージ容量を節約することができます。

