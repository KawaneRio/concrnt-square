+++
title="ConcrntSquare"
+++

# Concrnt Square
Concrnt Squareは分散型SNS「Concrnt(コンカレント)」の始め方からサーバー運用方法、開発ノウハウまで、様々な情報を集約しているサイトです。
主なwebクライアントとして[concrnt.world](https://concrnt.world)が配信されています。

## コンカレントとは
コンカレントは、全く新しいタイプの分散型SNS基盤です。この基盤を利用したアプリケーションとして"concrnt.world"が提供されています。

分散型SNSと一言に言っても様々ですが、コンカレントはその中でも「誰でもサーバーを建てられる一方で、どのサーバーを利用していても得られる体験がほぼほぼ同じである」分散型を指向しています。


 Activitypubだと…

自分のアカウントの識別子がサーバーに依存してしまい、引っ越すとIDが変わってしまいます。

at-protocolだと…

繋がりたい人と繋がるために、BGSやAppViewなどの外部のコンテキストに依存する必要があります。

Nostrだと…

一般リレーでは投稿の永続性を保証しませんし、また投稿が削除できることも保証されません。


## コンカレが指向すること

- 自分のアカウントを、自分が選んだ国・運営者の元に作成することができる

コンカレントは分散型SNSです。誰でもサーバーを建て、提供することができます。
自分でサーバーを建てられない人も、自分で「管理される」サーバーを選ぶことができます。

- 自分のアカウントが第三者によって削除・凍結され、回復不能にならない


SNSアカウントが個々人の「ウェブ上での家」であり、ポートフォリオにもなる現代において、自分のアカウントが第三者の意思によって凍結ないしは削除されることはあってはなりません。

中央集権型のSNSや、自身の識別子がサービスのドメイン名に紐づく大部分のActivitypubサービスでは、サービスの運営によって識別子を失ってしまう・無効化されてしまう可能性があります。

<!--
これは、あなたのアカウントの持ち主があなたであることを、ドメインを所持している「サーバーが」代わりに証明してくれる方法だからです。
サーバーは、IDとパスワードを用いてあなたを識別し、
それでは、特定のサーバーを所持しないあなたが、あなた自身のちからであなたのアカウントの所有者であることをどのように証明すればよいのでしょうか？
-->

コンカレントは、nostr等と同じく「秘密鍵を用いた電子署名」を用いる方法でこれを克服しています。
ユーザーは秘密鍵により自分の投稿を署名し、サーバーに投稿します。
閲覧者はサーバーから受け取ったメッセージの署名を検証することで、それが本当にあなたによって発信されたメッセージであることを確認することができます。

- アカウントを自由に引っ越しすることができる

コンカレントでは、ユーザーがリクエストしたDBの変更リクエストがすべてログとして保存されています。このログを他のサーバーに持ち出し、「引っ越し届」を世界に発信することで、あなたのアカウントをいつでも別のサーバーに引っ越すことができます。(変更が世界に一瞬で反映されるわけではなく、しばらく所在不明になる期間もありますが、いずれ収束します)

また、このログデータについてもユーザーがいつでも手動でダウンロードできる上、今後はGoogleDriveやその他ストレージサービスと連携するモジュールを用意し、定期的に保存される仕組みを提供する予定です。

- どのサーバーに所属していても、同じような体験を得ることができる

コンカレントでは独自のプロトコルを使うことで、すべてのサーバーで得られる体験が同じになるようにします。分散するインセンティブはありませんが、集中するインセンティブもありません。


---

- 友達が「今、なにしてる？」のかをリアルタイムで知ることができる

タイムラインはウソみたいなXのホームではなく、コンカレはタイムラインで投稿を「時系列順」に並べ、またリクエストすれば新着メッセージをリアルタイムで受信するAPIを提供しています。


- 過去の自分の投稿を消去することができる
多くの分散型SNSでは投稿を関連サーバーに転送し、コピーを保管しているため、投稿が削除できないケースが存在します。
コンカレントでは、他のサーバーのメッセージの本文を一切保存しません(利用の監査のため、ログに残るケースはあります)。
他のサーバーに保管されるのはそのメッセージへの「リンク」のみであり、実際にメッセージ本文はそのタイムラインを読みたいユーザー自身がその外部サーバーにアクセスしにいく方式を取っています。
これにより、自分のサーバー上で投稿を削除すれば、他人がその投稿を閲覧することはできなくなります。

- 自分の投稿の可視性を相手によってコントロールすることができる

コンカレントはSNSの中でも情報発信・情報収集が主目的である「ソーシャルメディア」は指向しておらず、「コミュニケーションツール」を指向しています。
そのため、Twitterの鍵垢のように「特定のユーザーにのみ」自分の投稿を見せたいといったユースケースがあることを尊重しています。
コンカレントでは協力な「ポリシー」機能により、自分の投稿を見る人が誰なのか、細かく制御することができます。
また、メッセージの本文は他のサーバーに保管されず、許可されたユーザーが直接問い合わせに来るため、外部のサーバー管理者に投稿内容を盗み見られることもありません。

- 繋がりたい人と繋がるのに必要な依存が最低限である
at-protocolないしBlueskyはデータベースのみ分散していますが、依然としてそれを集約し、アプリで表示してくれるサーバー群の管理は中央集権的です。
これにより、at-protocol上でユーザーを完全にbanすることができなくても、blueskyのサービス上でユーザーをbanすることは依然として可能です。

コンカレントはサーバーにデータベースとしての機能も、SNSとしての機能もオールインワンで提供されており、その体験が外部の政治に影響されることはありません。

- 個々人が自己表現を行い、友達とコミュニケーションを取ることができる
- 人間にとって自然な「複数のコミュニティに所属した状態」を表現できる

- 簡単に安全にサードパーティアプリと連携できる

秘密鍵は他人にバレてしまえば一巻の終わりであり、そのアカウントの安全性を取り戻すことはできません。そこで、コンカレントでは「サブキー」という仕組みを導入しています。これは秘密鍵や、有効な他のサブキーから派生させて作ることのできる鍵です。この鍵は秘密鍵の代わりとして認証でき、またいつでも他のまだ有効な鍵を利用してその効力を停止させることができます。
これにより、本体である秘密鍵は金庫などの安全な箇所に保管し門外不出にしたうえで、サブキーを用いてコンカレントを利用することができます。
信頼度が未知数であるサードパーティーアプリに関しても、サブキーのみを渡すことで比較的安全に利用することができます。

また、クライアントアプリではなくユーザーの代わりにカレントを投稿する程度であれば、サブキーを使うまでもありません。
ユーザーのホームタイムラインの書き込み権限は、鍵垢を実現しているポリシー機能と同様の機能で実現されています。
ホームタイムラインのポリシーを編集し、連携アプリのBotユーザーが書き込めるように許可をすれば、それだけで外部ユーザーに自分のタイムラインへの書き込みを許可することができます。また、その際のbotアカウントのアイコンに関しても、サブプロフィールという仕組みを使うことで、一時的に他のユーザーのプロフィール画像を借りることが可能なので、実用上問題ない見た目で、安全にこの許可を与えることが可能です。

- サーバーの維持・管理がそれほど大変ではない
コンカレントは外部のユーザーの投稿を一切保存しないため、DBの膨れ上がるスピードが緩やかです。
また、外部への投稿の配送も行わないため、休止サーバーに対して配信を停止する等のオペレーションが不要です。
リアルタイム通信は、それがリクエストされている間のみセッションが作成され、誰も自分のサーバーの情報を参照していない時間帯は、サーバーは一切の処理を行いません。

ユーザーがあるタイムラインの購読をリクエストした際、一時的にタイムラインを構成する外部リンクのリストのキャッシュを生成しますが、これも時間が建てば削除されますし、障害等の理由でキャッシュが突然消失しても、整合性の破綻なく再度外部からキャッシュを再構築します。

Activitypubのような運用性のクセを最低限に、運用しやすいプロトコルになっています。


## コンカレが指向しないこと
以下はモジュールや外部サービスとして存在することは否定しないが、コンカレント本体に機能として実装することはない。
- いわゆる個人が「情報発信を行うためのツール」であるソーシャルメディアは指向しない
    - リコメンド等のフィードは提供しない
    - あくまでも個人間でのコミュニケーションを大切にしている為。
- ユーザー検索
    - 検索結果のユーザーがなりすましでないこと、あなたの人違いでないことを保証することはできません。
    直接その人物から名刺をもらったり、あなたが信頼しているwebサイトや他のsnsからのリンクを参照するべきです。

## グレーである箇所
- オプトインされたサーバーからのみ構成されるFirehorseは提供してもよい
    - ingest filterによる「エゴサ」や、直近数時間に限定したグローバルな検索は提供してもよい


## 各指向について詳しく

### 




<div align="center">
    <img src="/images/mentalmodel.png" width="500px" >
</div>

コンカレントはMastodonやmisskeyなどの連合型分散と、Nostrなどの無責任中継分散の中間のような、新しい分散型SNS基盤です。その細部にはこれらのプラットフォームとは異なる独自の機能と哲学があります。


一方で、BlueskyはXと同様のインターフェースを持ち、個人個人が直接世界とつながるといったトポロジーを持っているのに対して、コンカレントは「ユーザーがまずたくさんのコミュニティとつながり、それらのコミュニティの相互作用から世界が形成される」といったトポロジーを追求しています。
簡単に言うなれば、Xのように世界とつながりすぎているわけでもなく、Discordのように環境が閉じすぎているわけでもない、適度にほかのコミュニティと接続し世界とつながれるSNSを指向しています。

つまり、**世界との過度な直結も、過度な閉鎖性も避け、コミュニティとの健全な接続を通じて世界とつながるバランスを目指すSNS**です。


コンカレは数ある分散型の中でも、「誰でもサーバーを建てられる一方で、どのサーバーを利用していても、得られる体験がほぼほぼ同じである」分散型を指向しています。

そのため、サーバー間の通信には独自のプロトコルを利用しています。

というのも、既存のプロトコルを利用した場合サービスとして持ちうる表現力がそのプロトコルの表現力に制限されてしまいます。日々要求される要件が変化するSNSの世界で、アプリケーションの開発のスピードをプロトコルの成熟スピードに制限されてしまうのはナンセンスでしょう。

一方でConcrntはActivityPub等の共通プロトコルをモジュールと言う形で提供し、任意でサーバーに組み込めるようにしています。

サーバーでモジュールを有効化すると、サーバーがConctnt間の通信プロトコルだけでなく、その他のプロトコルも話すようになります。いわゆる、組み込みのBridgeのようなものです。nin

これにより、Concrntのアプリケーション間ではConcrntがもたらすk最大の体験を得ることができ、またActivityPub等のほかプロトコルと互換性のある機能については、モジュールを通して外部のユーザーと交流することもできます。

### コンカレが提供したい体験

- 友達が「今、なにしてる？」のかをリアルタイムで知ることができる
- 自分のアカウントのIDが誰にもBANされない
- 過去の自分の投稿を全てエクスポートすることができる
- 過去の自分の投稿を消去することができる
- 自分の投稿の可視性を相手によってコントロールすることができる
- 繋がりたい人と繋がるのに必要な依存が最低限である
- コミュニティやイベントタイムラインを持ち

### 既存のプロトコルの問題点

Activitypubだと…

自分のアカウントの識別子がサーバーに依存してしまい、引っ越すとIDが変わってしまいます。

at-protocolだと…

繋がりたい人と繋がるために、BGSやAppViewなどの外部のコンテキストに依存する必要があります。

Nostrだと…

一般リレーでは投稿の永続性を保証しませんし、また投稿が削除できることも保証されません。

### コンカレはこれをどのように実現しているのか

- アカウントの識別子を、秘密鍵により担保します
- ある瞬間においてユーザーは1つのサーバーに所属するモデルをとり、そのサーバーがユーザーのコンテンツの配信や削除等の管理の全責任を負います
    - 自分の全ての発言が現住所サーバーに保管される為、簡単にエクスポートできます
    - ユーザーは自身のデータをコピーすることで、他のサーバーに引っ越せます
- コンカレは1つのサーバーでSNSとして必要な全ての機能を完結させているので、外部のコンポーネントに依存しません




